# Git Submodule (субмодуль в Git)

Субмодуль — это отдельное Git-хранилище, которое встраивается в другое хранилище (родительский репозиторий). Это удобно, если вы хотите разделить большую кодовую базу на несколько частей или включать сторонние библиотеки, имеющие собственный репозиторий. Субмодули позволяют вам поддерживать отдельные ветки, коммиты и историю для каждого проекта, которые вложены в родительский репозиторий.

## Как создать субмодуль

Допустим, у вас есть основной репозиторий `parent-repo`, и вы хотите добавить туда другой репозиторий `child-repo` 
как субмодуль.

```
cd parent-repo
git submodule add https://github.com/user/child-repo.git child-repo
git commit -m "Added child-repo as a submodule"
git push origin master
```

Теперь у вас есть вложенный репозиторий (`child-repo`), который живёт внутри основного репозитория (`parent-repo`).

## Как скачать удалённые репозиторий с субмодулями

### Способ 1
Скачать и инициализировать субмодули (submodules) в локальном репозитории Git можно с помощью команды

```
git clone --recurse-submodules https://github.com/user/parent-repo
```

позволяет сразу клонировать репозиторий вместе со всеми его субмодулями. 
То есть, при выполнении этой команды Git автоматически скачает основной репозиторий и все вложенные в него субмодули, 
что избавляет от необходимости дополнительно инициализировать и обновлять их вручную.

**Что делает эта команда:**

- `git clone`: Скачивает репозиторий с удалённого сервера.
- `--recurse-submodules`: Рекурсивно скачивает и инициализирует все субмодули, содержащиеся в основном репозитории.
- `https://github.com/user/parent-repo`: ссылка на репозиторий

Если мы хотим сразу получить и основной репозиторий, и все его субмодули, то эта команда — оптимальный выбор.

### Способ 2

Чтобы скачать и инициализировать субмодули (submodules) в локальном репозитории Git, выполните следующие шаги:

1. Скачать и инициализировать субмодули:
   Когда вы клонировали репозиторий с субмодулями, вам нужно явно сказать Git’у, чтобы он инициализировал 
и скачал эти субмодули. Сделать это можно с помощью команды:

```
git submodule update --init --recursive
```

- `--init`: инициализирует субмодули, указанные в .gitmodules.
- `--recursive`: если ваши субмодули также содержат свои собственные субмодули, эта опция рекурсивно скачает их.

2. Обновить субмодули (при необходимости):
   Если субмодули были обновлены в удалённом репозитории, вы можете обновить их локально с помощью команды:

```
git submodule update --remote --merge
```

- `--remote`: переключает субмодули на ветку, указанную в их remote-url.
- `--merge`: сливает изменения из удалённого репозитория в текущую ветку.

3. Добавить изменения в локальный репозиторий:
   Если вы внесли изменения в субмодули, вам нужно закоммитить изменения как в субмодулях, 
так и в главном репозитории:

- Зайдите в папку субмодуля

    ```
    cd submodule_directory
    ```

- Сделайте коммит в субмодуле
    ```
    git add .
    git commit -m "Updated submodule code"
    git push origin main
    ```

- Вернитесь в корень родительского репозитория
    ```
    - cd ..
    ```

- Обновите главную ветвь родительского репозитория
    ```
    git add .
    git commit -m "Update submodule reference"
    git push origin main
    ```

#### Итог:
Используйте команду git submodule update --init --recursive, чтобы инициализировать и загрузить субмодули.
Для обновления субмодулей используйте git submodule update --remote --merge.
Помните, что изменения в субмодулях должны быть зафиксированы как в самом субмодуле, так и в родительском репозитории.
